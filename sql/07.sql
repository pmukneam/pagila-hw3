/*
 * List all actors with Bacall Number 2;
 * That is, list all actors that have appeared in a film with an actor that has appeared in a film with 'RUSSELL BACALL',
 * but do not include actors that have Bacall Number < 2.
 */

select (first_name || ' ' || last_name) as "Actor Name" from (select actor_id from (select actor_id from (select distinct actor_id from (select distinct film_id from film join film_actor using (film_id) join actor using (actor_id) where ((first_name || ' ' || last_name) = 'RUSSELL BACALL') or (actor_id in (select actor_id from (select actor_id from (select distinct actor_id from (select film_id from film join film_actor using (film_id) join actor using (actor_id) where (first_name || ' ' || last_name) = 'RUSSELL BACALL')a join film_actor using(film_id))c)g except (select distinct actor_id from film_actor join actor using (actor_id) where (first_name || ' ' || last_name) = 'RUSSELL BACALL'))))a join film_actor using (film_id))a where actor_id not in (select actor_id from (select actor_id from (select distinct actor_id from (select film_id from film join film_actor using (film_id) join actor using (actor_id) where (first_name || ' ' || last_name) = 'RUSSELL BACALL')a join film_actor using(film_id))c)g except (select distinct actor_id from film_actor join actor using (actor_id) where (first_name || ' ' || last_name) = 'RUSSELL BACALL')))a where actor_id != 112)temp1 join actor using (actor_id) order by "Actor Name";
